# 디플로이먼트 중심 배포 (Deployment for Services)

## 정의

대부분의 애플리케이션 서비스를 `Deployment` 리소스로 배포해, 복제(Replica), 롤링 업데이트, 자가 복구를 표준화하는 운영 방식.

## 왜 중요한가?

- 서비스 운영에서 기본 요구인 리던던시와 스케일링을 기본값으로 가져갈 수 있다.
- 무중단에 가까운 롤링 배포가 가능해 배포 리스크를 낮춘다.
- 워크로드 운영 모델이 통일되면 팀 간 운영 복잡도가 줄어든다.

## 책 내용 핵심 정리

- 대부분의 서비스는 디플로이먼트로 배포하는 것이 좋다.
- 동일 레플리카를 손쉽게 관리해 장애 대응과 확장에 유리하다.
- 단, 상태 저장 워크로드는 StatefulSet 등 다른 리소스가 더 적합할 수 있다.

## 실무 포인트

### 1. 기본 레플리카 정책
- 운영 서비스는 최소 `replicas: 2` 이상을 기본으로 둔다.
- 단일 파드 구성은 개발/테스트 외에는 예외로 관리한다.

### 2. 배포 전략 표준화
- `RollingUpdate`의 `maxUnavailable`/`maxSurge`를 서비스 특성에 맞게 사전 정의한다.
- readinessProbe가 통과한 파드만 트래픽을 받게 보장한다.

### 3. 확장/가용성 연계
- HPA와 PDB를 함께 설계해 스케일링과 가용성을 동시에 관리한다.
- 노드 장애/점검 시 파드 쏠림이 생기지 않도록 anti-affinity를 검토한다.

## 바로 적용 가능한 체크리스트

- [ ] 서비스별 Deployment 기본 템플릿(Probe, Resource, Strategy)을 사용한다.
- [ ] 운영 워크로드 기본 복제 개수를 명시했다.
- [ ] 롤링 업데이트 파라미터를 서비스 등급별로 분류했다.
- [ ] StatefulSet/Job 등 예외 워크로드는 선택 근거를 남긴다.

## 실무 한 줄

서비스 배포의 기본값을 Deployment로 통일하면, 장애 대응과 배포 품질을 운영 체계로 만들 수 있다.

## 관련 개념

- ReplicaSet
- RollingUpdate
- HPA / PDB
- Stateless vs Stateful

## 출처

- 쿠버네티스 창시자에게 배우는 모범 사례 2판
